(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ea274ac"],{"2a48":function(t,e,s){},"46be":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-submission"},[s("el-form",{ref:"form",attrs:{model:t.form}},[s("el-form-item",{attrs:{label:"上传中期审核材料"}},[s("el-upload",{staticClass:"upload-demo",attrs:{"before-upload":t.beforeUpload,"file-list":t.fileList,"http-request":t.uploadRequest,"show-file-list":!1}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传 PDF 文件")])],1)],1),s("el-form-item",{attrs:{label:"审核状态"}},[s("el-tag",{attrs:{type:t.statusType}},[t._v(t._s(t.statusMessage))])],1)],1)],1)},u=[],r=s("5530"),n=(s("99af"),s("d3b7"),s("2f62")),o={data:function(){return{form:{},fileList:[],statusType:"success",statusMessage:"",uploadUrl:"http://localhost:9001/student/uploadFile",docType:2,statusUrl:"http://localhost:9001/student/getDocInfo"}},computed:Object(r["a"])({},Object(n["c"])(["userId"])),mounted:function(){this.updateDocStatus()},methods:{beforeUpload:function(t){var e="application/pdf"===t.type;return e||this.$message.error("只能上传 PDF 文件"),e},uploadRequest:function(t){var e=this,s=t.file,a=t.onSuccess,u=t.onError,r=new FormData;r.append("file",s.raw||s),r.append("userId",this.userId),r.append("docType",this.docType),fetch(this.uploadUrl,{method:"POST",body:r}).then((function(t){return t.json()})).then((function(t){if(t.success){var s=t.message.docStatus;e.statusType=e.getStatusType(s),e.statusMessage=e.getStatusMessage(s)}else e.statusType="danger",e.statusMessage=t.message||"上传失败";a(t)})).catch((function(t){e.statusType="danger",e.statusMessage="上传失败",u(t)}))},getStatusType:function(t){switch(t){case 0:return"warning";case 1:return"info";case 2:return"success";case 3:return"danger";default:return"default"}},getStatusMessage:function(t){switch(t){case 0:return"未提交";case 1:return"评审中";case 2:return"通过评审";case 3:return"未通过评审";default:return"状态未知"}},updateDocStatus:function(){var t=this,e=new Headers;e.append("User-Agent","Apifox/1.0.0 (https://apifox.com)");var s={method:"POST",headers:e,redirect:"follow"};fetch("".concat(this.statusUrl,"?userId=").concat(this.userId,"&docType=").concat(this.docType),s).then((function(t){return t.json()})).then((function(e){if(e.success){var s=e.message.docStatus;t.statusType=t.getStatusType(s),t.statusMessage=t.getStatusMessage(s)}else t.statusType="danger",t.statusMessage="获取状态失败"})).catch((function(e){t.statusType="danger",t.statusMessage="获取状态失败"}))}}},c=o,i=(s("a7b7"),s("2877")),l=Object(i["a"])(c,a,u,!1,null,"7e92d411",null);e["default"]=l.exports},a7b7:function(t,e,s){"use strict";s("2a48")}}]);